var e={name:"calender-picker",props:{selectData:{type:Array,default:()=>[]},type:{type:String,default:"date"},isOpen:{type:Boolean,default:!0}},data:()=>({monthData:[],week:["日","一","二","三","四","五","六"],year:"",month:"",start:null,end:null,dateData:[],loading:!0}),watch:{isOpen:{handler(e){if(e){this.dateData=this.selectData;const[e,t]=[this.dateData?.[0]?.split("-"),this.dateData?.[1]?.split("-")];this.start=null==e?null:new Date(e[0],e[1]-1,e[2]),this.end=null==t?null:new Date(t[0],t[1]-1,t[2]),this.init()}},immediate:!0}},computed:{dateText(){return`<span class="start-date">${this.dateData?.[0]}${null==this.dateData?.[1]?"</span>":'</span> 至 <span class="end-date">'+this.dateData?.[1]}`}},mounted(){this.addEvent()},methods:{addEvent(){document.querySelector(".calender-picker").addEventListener("click",(e=>{e.stopPropagation();const t=e.target,a=t.classList;if((a.contains("calender-picker__btn")||a.contains("calender-picker__day")||a.contains("start-date")||a.contains("end-date"))&&!a.contains("calender-picker__btn--disabled")&&!a.contains("calender-picker__day--disabled")){if(a.contains("calender-picker__btn")||a.contains("start-date")||a.contains("end-date")){let e=null;if(a.contains("calender-picker__btn-prev--year"))e=this.fixMonthToYear(this.year-1,this.month);else if(a.contains("calender-picker__btn-prev--month"))e=this.fixMonthToYear(this.year,this.month-1);else if(a.contains("calender-picker__btn-next--month"))e=this.fixMonthToYear(this.year,this.month+1);else if(a.contains("calender-picker__btn-next--year"))e=this.fixMonthToYear(this.year+1,this.month);else{const a=t.innerHTML.split("-");e=this.fixMonthToYear(+a[0],+a[1])}this.setMonthDate(e.year,e.month)}else if(a.contains("calender-picker__day")){const e=this.judgeDayType(a);this.setStartEndDate(e,t),this.dateData=[this.formatDate(this.start),this.formatDate(this.end)]}this.reRender()}}),!1)},swipeRight(){const e=this.fixMonthToYear(this.year,this.month-1);this.setMonthDate(e.year,e.month),this.reRender()},swipeLeft(){const e=this.fixMonthToYear(this.year,this.month+1);this.setMonthDate(e.year,e.month),this.reRender()},reRender(){this.clearUI(),this.$nextTick().then((()=>{this.renderUI(),this.renderClickUI()}))},init(e=this.start?.getFullYear(),t=this.start?.getMonth()+1){this.setMonthDate(e,t),this.reRender()},renderUI(){const e=this.fixMonthToYear(this.year,this.month+1),t=new Date(e.year,e.month-1),a=new Date;if(t-a>0){const e=document.getElementsByClassName("calender-picker__btn-next--month")[0].classList,t=document.getElementsByClassName("calender-picker__btn-next--year")[0].classList;e.add("calender-picker__btn--disabled"),t.add("calender-picker__btn--disabled")}const n=document.getElementsByClassName("calender-picker__day"),r=n.length;for(let e=0;e<r;e++){const t=this.monthData[e];if(new Date(t?.year,t?.month-1,t?.showDate)-a>0)for(;e<r;){n[e].classList.add("calender-picker__day--disabled"),e++}}},renderClickUI(){if(!this.start)return;const[e,t]=[this.monthData[0],this.monthData[this.monthData.length-1]],a=new Date(e.year,e.month-1,e.showDate),n=new Date(t.year,t.month-1,t.showDate);if(this.start-n>0||this.end&&this.end-a<0)return;const r=document.getElementsByClassName("calender-picker__day");for(let e=0;e<r.length;e++){const t=this.monthData[e],a=new Date(t.year,t.month-1,t.showDate),n=r[e].classList;if(!this.end&&this.start-a==0){n.add("calender-picker__day--start");break}if(this.start-a!=0){if(this.start-a<0&&a-this.end<0)n.add("calender-picker__day--middle");else if(this.end-a==0){n.add("calender-picker__day--end","select-both");break}}else{if(this.end===this.start){n.remove("calender-picker__day--start"),this.start=null,this.end=null,this.dateData=[];break}n.add("calender-picker__day--start","select-both")}}},judgeDayType(e){let t="currMonth";return e.contains("prev-month")?t="prevMonth":e.contains("next-month")&&(t="nextMonth"),t},setStartEndDate(e,t){const a=t.innerHTML;let n=null,r=null;switch(e){case"currMonth":r=this.fixMonthToYear(this.year,this.month);break;case"prevMonth":r=this.fixMonthToYear(this.year,this.month-1);break;case"nextMonth":r=this.fixMonthToYear(this.year,this.month+1)}n=new Date(r.year,r.month-1,a),!this.start||this.start&&this.end?(this.start=n,this.end=null):this.start-n==0?this.end=this.start:this.start-n>0?(this.end=this.start,this.start=n):this.end=n},setMonthDate(e,t){if(!e||!t){const a=new Date;e=a.getFullYear(),t=a.getMonth()+1}let a=new Date(e,t-1,1).getDay();0===a&&(a=7);let n=new Date(e,t-1,0).getDate(),r=a,i=new Date(e,t,0).getDate(),d=35,s=i+r;s>d?d+=7:s<=d-7&&(d-=7),this.monthData=this.getMonthData(d,e,t,r,n,i),this.year=e,this.month=t},getMonthData(e,t,a,n,r,i){const d=[];let s,c,o;for(let l=0;l<e;l++){s=l+1-n,c=s,o=a,s<=0?(o=a-1,c=r+s):s>i&&(o=a+1,c-=i);const e=this.fixMonthToYear(t,o);d.push({year:e.year,month:e.month,date:s,showDate:c})}return d},fixMonthToYear:(e,t)=>(0===t&&(t=12,e-=1),13===t&&(t=1,e+=1),{year:e=e||0,month:t}),formatDate:e=>e?`${e.getFullYear()}-${e.getMonth()+1<10?`0${e.getMonth()+1}`:e.getMonth()+1}-${e.getDate()<10?`0${e.getDate()}`:e.getDate()}`:e,clearUI(){this.loading=!1,this.$nextTick((()=>{this.loading=!0}))},cancel(){this.dateData=[],this.start=null,this.end=null,this.setMonthDate(),this.reRender()},confirm(e){this.confirmData(e,this.dateData)},confirmData(e,t){const a=t[1]?[t[0],t[1]]:t[0]?[t[0]]:[];this.$emit("confirm",e,a)}}};var t=function(e,t,a,n,r,i,d,s,c,o){"boolean"!=typeof d&&(c=s,s=d,d=!1);var l,h="function"==typeof a?a.options:a;if(e&&e.render&&(h.render=e.render,h.staticRenderFns=e.staticRenderFns,h._compiled=!0,r&&(h.functional=!0)),n&&(h._scopeId=n),i?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,c(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},h._ssrRegister=l):t&&(l=d?function(){t.call(this,o(this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),l)if(h.functional){var _=h.render;h.render=function(e,t){return l.call(t),_(e,t)}}else{var p=h.beforeCreate;h.beforeCreate=p?[].concat(p,l):[l]}return a},a="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var n=document.head||document.getElementsByTagName("head")[0],r={};const i=t({render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"calender-picker"},[a("div",{staticClass:"calender-picker__custom"},[a("span",{staticClass:"calender-picker__custom--text"},[e._v("自定义日期")]),e._v(" "),a("span",{staticClass:"calender-picker__custom--value"},[e.dateData.length?a("span",{domProps:{innerHTML:e._s(e.dateText)}}):a("span",[e._v("请选择日期")])])]),e._v(" "),e.loading?a("div",{staticClass:"calender-picker__header"},[e._m(0),e._v(" "),a("div",{staticClass:"calender-picker__header-middle"},[e._v(e._s(e.year)+" 年 "+e._s(e.month)+" 月")]),e._v(" "),e._m(1)]):e._e(),e._v(" "),a("div",{staticClass:"calender-picker__body"},[a("div",{staticClass:"calender-picker__weeks"},e._l(e.week,(function(t){return a("div",{key:t,staticClass:"calender-picker__week"},[e._v(e._s(t))])})),0),e._v(" "),e.loading?a("div",{staticClass:"calender-picker__month"},e._l(e.monthData,(function(t){return a("div",{key:t.date,class:["calender-picker__day",t.date<t.showDate&&"prev-month",t.date>t.showDate&&"next-month"]},[e._v("\n        "+e._s(t.showDate)+"\n      ")])})),0):e._e()])])},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"calender-picker__header-prev"},[a("span",{staticClass:"calender-picker__btn calender-picker__btn-prev--year"},[e._v("<<")]),e._v(" "),a("span",{staticClass:"calender-picker__btn calender-picker__btn-prev--month"},[e._v("<")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"calender-picker__header-next"},[a("span",{staticClass:"calender-picker__btn calender-picker__btn-next--month"},[e._v(">")]),e._v(" "),a("span",{staticClass:"calender-picker__btn calender-picker__btn-next--year"},[e._v(">>")])])}]},(function(e){e&&e("data-v-031047a0_0",{source:'.calender-picker__body .calender-picker__weeks[data-v-031047a0],.calender-picker__custom[data-v-031047a0],.calender-picker__header[data-v-031047a0],.justify-content--space-between[data-v-031047a0]{display:flex;justify-content:space-between}.calender-picker[data-v-031047a0]{height:60vh;display:flex;flex-direction:column;background-color:#fff;padding:16px 16px 0;color:#00000a;border-radius:0 0 16px 16px}.calender-picker__custom--text[data-v-031047a0]{font-weight:600;font-size:16px}.calender-picker__custom--value[data-v-031047a0]{color:#393a51}.calender-picker__header[data-v-031047a0]{align-items:center;padding:24px 5px 11px;color:#393a51}.calender-picker__header .calender-picker__btn[data-v-031047a0]{font-family:serif}.calender-picker__header .calender-picker__btn-prev--month[data-v-031047a0]{padding-left:20px}.calender-picker__header .calender-picker__btn-next--month[data-v-031047a0]{padding-right:20px}.calender-picker__header .calender-picker__btn--disabled[data-v-031047a0]{color:#b3b5c5}.calender-picker__header-middle[data-v-031047a0]{color:#000;font-size:16px;font-weight:600}.calender-picker__body[data-v-031047a0]{overflow:auto}.calender-picker__body .calender-picker__weeks[data-v-031047a0]{height:36px;line-height:36px;padding-bottom:4px}.calender-picker__body .calender-picker__weeks .calender-picker__week[data-v-031047a0]{flex:1;font-size:12px;text-align:center;color:#393a51}.calender-picker__body .calender-picker__month[data-v-031047a0]{display:grid;grid-template-columns:repeat(7,auto)}.calender-picker__body .calender-picker__month .calender-picker__day[data-v-031047a0]{text-align:center;height:40px;line-height:40px}.calender-picker__body .calender-picker__month .calender-picker__day--end[data-v-031047a0],.calender-picker__body .calender-picker__month .calender-picker__day--middle[data-v-031047a0],.calender-picker__body .calender-picker__month .calender-picker__day--start[data-v-031047a0],.calender-picker__body .calender-picker__month .calender-picker__day--start-end[data-v-031047a0]{color:#fff!important;position:relative;z-index:1}.calender-picker__body .calender-picker__month .calender-picker__day--end[data-v-031047a0]::after,.calender-picker__body .calender-picker__month .calender-picker__day--middle[data-v-031047a0]::after,.calender-picker__body .calender-picker__month .calender-picker__day--start-end[data-v-031047a0]::after,.calender-picker__body .calender-picker__month .calender-picker__day--start[data-v-031047a0]::after{position:absolute;content:"";height:32px;width:32px;border-radius:50%;background-color:#1a53ff;z-index:-1;top:0;bottom:0;left:0;right:0;margin:auto}.calender-picker__body .calender-picker__month .calender-picker__day--middle[data-v-031047a0]{color:#00000a!important}.calender-picker__body .calender-picker__month .calender-picker__day--middle[data-v-031047a0]::after{width:inherit;border-radius:unset;background-color:#e9eeff}.calender-picker__body .calender-picker__month .calender-picker__day--start.select-both[data-v-031047a0]{height:32px;line-height:32px;margin:auto 0;background:linear-gradient(to right,transparent 0,transparent 50%,#e9eeff 51%,#e9eeff 100%)}.calender-picker__body .calender-picker__month .calender-picker__day--end.select-both[data-v-031047a0]{height:32px;line-height:32px;margin:auto 0;background:linear-gradient(to right,#e9eeff 0,#e9eeff 50%,transparent 51%,transparent 100%)!important}.calender-picker__body .calender-picker__month .calender-picker__day.next-month[data-v-031047a0],.calender-picker__body .calender-picker__month .calender-picker__day.prev-month[data-v-031047a0]{color:#b3b5c5}.calender-picker__body .calender-picker__month .calender-picker__day--disabled[data-v-031047a0]{color:#b3b5c5}',map:void 0,media:void 0})}),e,"data-v-031047a0",false,undefined,!1,(function(e){return function(e,t){return function(e,t){var i=a?t.media||"default":e,d=r[i]||(r[i]={ids:new Set,styles:[]});if(!d.ids.has(e)){d.ids.add(e);var s=t.source;if(t.map&&(s+="\n/*# sourceURL="+t.map.sources[0]+" */",s+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),d.element||(d.element=document.createElement("style"),d.element.type="text/css",t.media&&d.element.setAttribute("media",t.media),n.appendChild(d.element)),"styleSheet"in d.element)d.styles.push(s),d.element.styleSheet.cssText=d.styles.filter(Boolean).join("\n");else{var c=d.ids.size-1,o=document.createTextNode(s),l=d.element.childNodes;l[c]&&d.element.removeChild(l[c]),l.length?d.element.insertBefore(o,l[c]):d.element.appendChild(o)}}}(e,t)}}),void 0,void 0);export{i as default};
